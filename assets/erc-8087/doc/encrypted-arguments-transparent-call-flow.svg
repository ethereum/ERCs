<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1435px" preserveAspectRatio="none" style="width:2044px;height:1435px;background:#FFFFFF;" version="1.1" viewBox="0 0 2044 1435" width="2044px" zoomAndPan="magnify"><title>Transparent Call Descriptor + Encrypted Arguments via Call Decryption Oracle (Init + Execution phases, separate target)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="872.2725" x="589.3706" y="28.5352">Transparent Call Descriptor + Encrypted Arguments via Call Decryption Oracle (Init + Execution phases, separate target)</text><g><title>User . Caller</title><rect fill="#000000" fill-opacity="0.00000" height="1234.8008" width="8" x="47.3032" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="50.8032" x2="50.8032" y1="118.9766" y2="1353.7773"/></g><g><title>Client Contract</title><rect fill="#000000" fill-opacity="0.00000" height="1234.8008" width="8" x="525.082" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="528.582" x2="528.582" y1="118.9766" y2="1353.7773"/></g><g><title/><rect fill="#FFCC80" height="86.9316" style="stroke:#181818;stroke-width:1;" width="10" x="523.582" y="325.1504"/></g><g><title/><rect fill="#FFCC80" height="446.3477" style="stroke:#181818;stroke-width:1;" width="10" x="523.582" y="500.7031"/></g><g><title>Call Decryption Oracle Contract</title><rect fill="#000000" fill-opacity="0.00000" height="1234.8008" width="8" x="1041.1733" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1044.6733" x2="1044.6733" y1="118.9766" y2="1353.7773"/></g><g><title/><rect fill="#8080FF" height="158.5527" style="stroke:#181818;stroke-width:1;" width="10" x="1039.6733" y="788.498"/></g><g><title/><rect fill="#8080FF" height="203.1738" style="stroke:#181818;stroke-width:1;" width="10" x="1039.6733" y="1118.6035"/></g><g><title>Call Decryption Oracle</title><rect fill="#000000" fill-opacity="0.00000" height="1234.8008" width="8" x="1401.8931" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1405.3931" x2="1405.3931" y1="118.9766" y2="1353.7773"/></g><g><title/><rect fill="#808080" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1400.3931" y="266.5293"/></g><g><title/><rect fill="#808080" height="113.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1400.3931" y="1004.6719"/></g><g><title>Target Contract</title><rect fill="#000000" fill-opacity="0.00000" height="1234.8008" width="8" x="1690.9224" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1694.4224" x2="1694.4224" y1="118.9766" y2="1353.7773"/></g><g><title/><rect fill="#FF8080" height="71.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1689.4224" y="629.9453"/></g><g><title/><rect fill="#FF8080" height="102.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1689.4224" y="1147.9141"/></g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85.6064" x="5" y="116.0234">User / Caller</text><ellipse cx="50.8032" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M50.8032,58.9883 L50.8032,85.9883 M37.8032,66.9883 L63.8032,66.9883 M50.8032,85.9883 L37.8032,100.9883 M50.8032,85.9883 L63.8032,100.9883" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="189.7998" x="433.6821" y="44.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102.0127" x="477.5757" y="65.0469">Client Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175.7998" x="440.6821" y="81.5352">(Business Logic / Storage)</text><line style="stroke:#181818;stroke-width:1;" x1="433.6821" x2="623.4819" y1="89.4883" y2="89.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.832" x="482.166" y="108.0234">(any contract)</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="228.1152" x="930.6157" y="44.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="214.1152" x="937.6157" y="65.0469">Call Decryption Oracle Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1042.4585" y="81.5352">&#160;</text><line style="stroke:#181818;stroke-width:1;" x1="930.6157" x2="1158.731" y1="89.4883" y2="89.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146.7813" x="971.2827" y="108.0234">ICallDecryptionOracle</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165.6074" x="1322.5894" y="44.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.6074" x="1329.5894" y="65.0469">Call Decryption Oracle</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1403.1782" y="81.5352">&#160;</text><line style="stroke:#181818;stroke-width:1;" x1="1322.5894" x2="1488.1968" y1="89.4883" y2="89.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.4268" x="1369.1797" y="108.0234">(off-chain)</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="189.7998" x="1599.5225" y="44.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.5859" x="1641.1294" y="65.0469">Target Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175.7998" x="1606.5225" y="81.5352">(Business Logic / Storage)</text><line style="stroke:#181818;stroke-width:1;" x1="1599.5225" x2="1789.3223" y1="89.4883" y2="89.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.832" x="1648.0063" y="108.0234">(any contract)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85.6064" x="5" y="1427.3125">User / Caller</text><ellipse cx="50.8032" cy="1362.2773" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M50.8032,1370.2773 L50.8032,1397.2773 M37.8032,1378.2773 L63.8032,1378.2773 M50.8032,1397.2773 L37.8032,1412.2773 M50.8032,1397.2773 L63.8032,1412.2773" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="189.7998" x="433.6821" y="1353.7773"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102.0127" x="477.5757" y="1374.3125">Client Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175.7998" x="440.6821" y="1390.8008">(Business Logic / Storage)</text><line style="stroke:#181818;stroke-width:1;" x1="433.6821" x2="623.4819" y1="1398.7539" y2="1398.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.832" x="482.166" y="1417.2891">(any contract)</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="228.1152" x="930.6157" y="1353.7773"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="214.1152" x="937.6157" y="1374.3125">Call Decryption Oracle Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1042.4585" y="1390.8008">&#160;</text><line style="stroke:#181818;stroke-width:1;" x1="930.6157" x2="1158.731" y1="1398.7539" y2="1398.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146.7813" x="971.2827" y="1417.2891">ICallDecryptionOracle</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165.6074" x="1322.5894" y="1353.7773"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.6074" x="1329.5894" y="1374.3125">Call Decryption Oracle</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1403.1782" y="1390.8008">&#160;</text><line style="stroke:#181818;stroke-width:1;" x1="1322.5894" x2="1488.1968" y1="1398.7539" y2="1398.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.4268" x="1369.1797" y="1417.2891">(off-chain)</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="189.7998" x="1599.5225" y="1353.7773"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.5859" x="1641.1294" y="1374.3125">Target Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175.7998" x="1606.5225" y="1390.8008">(Business Logic / Storage)</text><line style="stroke:#181818;stroke-width:1;" x1="1599.5225" x2="1789.3223" y1="1398.7539" y2="1398.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.832" x="1648.0063" y="1417.2891">(any contract)</text><path d="M34.8032,130.9766 L580.2207,130.9766 L580.2207,138.2871 L570.2207,148.2871 L34.8032,148.2871 L34.8032,130.9766" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="289.1055" style="stroke:#000000;stroke-width:1.5;" width="1391.5898" x="34.8032" y="130.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="500.4175" x="49.8032" y="144.5449">Init phase - generate encrypted hashed arguments: encArgs and argsHash</text><polygon fill="#FFFFFF" points="1393.3931,160.2871,1403.3931,164.2871,1393.3931,168.2871,1397.3931,164.2871" style="stroke:#FFFFFF;stroke-width:1;"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="50.8032" x2="1399.3931" y1="164.2871" y2="164.2871"/><line style="stroke:#181818;stroke-width:1;" x1="50.8032" x2="92.8032" y1="224.2188" y2="224.2188"/><line style="stroke:#181818;stroke-width:1;" x1="92.8032" x2="92.8032" y1="224.2188" y2="237.2188"/><line style="stroke:#181818;stroke-width:1;" x1="51.8032" x2="92.8032" y1="237.2188" y2="237.2188"/><polygon fill="#181818" points="61.8032,233.2188,51.8032,237.2188,61.8032,241.2188,57.8032,237.2188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.0176" x="57.8032" y="188.8555">build: argsPlain (e.g. abi.encode(...))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.8125" x="57.8032" y="204.166">compute: argsHash = keccak256(argsPlain)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="463.7788" x="57.8032" y="219.4766">build: ArgumentDecriptor argumentDecriptor = (eligibleCaller,argsPlaine)</text><polygon fill="#181818" points="1388.3931,262.5293,1398.3931,266.5293,1388.3931,270.5293,1392.3931,266.5293" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="50.8032" x2="1394.3931" y1="266.5293" y2="266.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="538.9478" x="57.8032" y="261.7871">encrypt: EncryptedHashedArguments encArgs = ENC(abi.decode(argumentDecriptor))</text><polygon fill="#181818" points="61.8032,291.8398,51.8032,295.8398,61.8032,299.8398,57.8032,295.8398" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="55.8032" x2="1399.3931" y1="295.8398" y2="295.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.8945" x="67.8032" y="291.0977">encArgs (argsHash, publicKeyId, ciphertext)</text><polygon fill="#181818" points="511.582,321.1504,521.582,325.1504,511.582,329.1504,515.582,325.1504" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="50.8032" x2="517.582" y1="325.1504" y2="325.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.8315" x="57.8032" y="320.4082">submitEncryptedArguments(encArgs)</text><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="575.582" y1="369.7715" y2="369.7715"/><line style="stroke:#181818;stroke-width:1;" x1="575.582" x2="575.582" y1="369.7715" y2="382.7715"/><line style="stroke:#181818;stroke-width:1;" x1="534.582" x2="575.582" y1="382.7715" y2="382.7715"/><polygon fill="#181818" points="544.582,378.7715,534.582,382.7715,544.582,386.7715,540.582,382.7715" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300.8408" x="540.582" y="349.7188">store encArgs.ciphertext and encArgs.argsHash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.5952" x="540.582" y="365.0293">(e.g. by order / proposal id)</text><polygon fill="#181818" points="61.8032,408.082,51.8032,412.082,61.8032,416.082,57.8032,412.082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="55.8032" x2="522.582" y1="412.082" y2="412.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.5063" x="67.8032" y="407.3398">acknowledgement / reference</text><path d="M34.8032,438.082 L532.4863,438.082 L532.4863,445.3926 L522.4863,455.3926 L34.8032,455.3926 L34.8032,438.082" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="891.6953" style="stroke:#000000;stroke-width:1.5;" width="2003.2104" x="34.8032" y="438.082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="452.6831" x="49.8032" y="451.6504">Execution phase - generate clientId, trigger decryption and execute</text><polygon fill="#FFFFFF" points="1393.3931,467.3926,1403.3931,471.3926,1393.3931,475.3926,1397.3931,471.3926" style="stroke:#FFFFFF;stroke-width:1;"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="50.8032" x2="1399.3931" y1="471.3926" y2="471.3926"/><polygon fill="#181818" points="511.582,496.7031,521.582,500.7031,511.582,504.7031,515.582,500.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="50.8032" x2="517.582" y1="500.7031" y2="500.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.291" x="57.8032" y="495.9609">conditionUpdate(...) / external trigger</text><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="575.582" y1="545.3242" y2="545.3242"/><line style="stroke:#181818;stroke-width:1;" x1="575.582" x2="575.582" y1="545.3242" y2="558.3242"/><line style="stroke:#181818;stroke-width:1;" x1="534.582" x2="575.582" y1="558.3242" y2="558.3242"/><polygon fill="#181818" points="544.582,554.3242,534.582,558.3242,544.582,562.3242,540.582,558.3242" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.3623" x="540.582" y="525.2715">detect precondition satisfied</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.9863" x="540.582" y="540.582">(e.g. all signatures collected or auction end)</text><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="575.582" y1="587.6348" y2="587.6348"/><line style="stroke:#181818;stroke-width:1;" x1="575.582" x2="575.582" y1="587.6348" y2="600.6348"/><line style="stroke:#181818;stroke-width:1;" x1="534.582" x2="575.582" y1="600.6348" y2="600.6348"/><polygon fill="#181818" points="544.582,596.6348,534.582,600.6348,544.582,604.6348,540.582,600.6348" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.6504" x="540.582" y="582.8926">generate clientId</text><polygon fill="#181818" points="1677.4224,625.9453,1687.4224,629.9453,1677.4224,633.9453,1681.4224,629.9453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="1683.4224" y1="629.9453" y2="629.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.5947" x="540.582" y="625.2031">registerArguments(clientId, encArgs.argsHash)</text><line style="stroke:#181818;stroke-width:1;" x1="1699.4224" x2="1741.4224" y1="659.2559" y2="659.2559"/><line style="stroke:#181818;stroke-width:1;" x1="1741.4224" x2="1741.4224" y1="659.2559" y2="672.2559"/><line style="stroke:#181818;stroke-width:1;" x1="1700.4224" x2="1741.4224" y1="672.2559" y2="672.2559"/><polygon fill="#181818" points="1710.4224,668.2559,1700.4224,672.2559,1710.4224,676.2559,1706.4224,672.2559" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308.5913" x="1706.4224" y="654.5137">argsHashByClientId[clientId] = encArgs.argsHash</text><polygon fill="#181818" points="544.582,697.5664,534.582,701.5664,544.582,705.5664,540.582,701.5664" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="538.582" x2="1688.4224" y1="701.5664" y2="701.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.4175" x="550.582" y="696.8242">Registered(clientId, argsHash)</text><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="575.582" y1="746.1875" y2="746.1875"/><line style="stroke:#181818;stroke-width:1;" x1="575.582" x2="575.582" y1="746.1875" y2="759.1875"/><line style="stroke:#181818;stroke-width:1;" x1="534.582" x2="575.582" y1="759.1875" y2="759.1875"/><polygon fill="#181818" points="544.582,755.1875,534.582,759.1875,544.582,763.1875,540.582,759.1875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.604" x="540.582" y="726.1348">construct CallDescriptor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="497.0913" x="540.582" y="741.4453">(eligibleCaller, targetContract = T, selector, clientId, argsHash, validUntilBlock)</text><polygon fill="#181818" points="1027.6733,784.498,1037.6733,788.498,1027.6733,792.498,1031.6733,788.498" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="1033.6733" y1="788.498" y2="788.498"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.9512" x="540.582" y="783.7559">requestCall(callDescriptor, encArgs)</text><line style="stroke:#181818;stroke-width:1;" x1="1049.6733" x2="1091.6733" y1="817.8086" y2="817.8086"/><line style="stroke:#181818;stroke-width:1;" x1="1091.6733" x2="1091.6733" y1="817.8086" y2="830.8086"/><line style="stroke:#181818;stroke-width:1;" x1="1050.6733" x2="1091.6733" y1="830.8086" y2="830.8086"/><polygon fill="#181818" points="1060.6733,826.8086,1050.6733,830.8086,1060.6733,834.8086,1056.6733,830.8086" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.7197" x="1056.6733" y="813.0664">require callDescriptor.argsHash == encArgs.argsHash</text><line style="stroke:#181818;stroke-width:1;" x1="1049.6733" x2="1091.6733" y1="875.4297" y2="875.4297"/><line style="stroke:#181818;stroke-width:1;" x1="1091.6733" x2="1091.6733" y1="875.4297" y2="888.4297"/><line style="stroke:#181818;stroke-width:1;" x1="1050.6733" x2="1091.6733" y1="888.4297" y2="888.4297"/><polygon fill="#181818" points="1060.6733,884.4297,1050.6733,888.4297,1060.6733,892.4297,1056.6733,888.4297" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.4136" x="1056.6733" y="855.377">store pending request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.5308" x="1056.6733" y="870.6875">(requestId, requester, callDescriptor)</text><polygon fill="#181818" points="544.582,913.7402,534.582,917.7402,544.582,921.7402,540.582,917.7402" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="538.582" x2="1038.6733" y1="917.7402" y2="917.7402"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.4712" x="550.582" y="912.998">requestId</text><polygon fill="#181818" points="544.582,943.0508,534.582,947.0508,544.582,951.0508,540.582,947.0508" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="538.582" x2="1038.6733" y1="947.0508" y2="947.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.4668" x="550.582" y="942.3086">emit CallRequested(...)</text><line style="stroke:#181818;stroke-width:1;" x1="1405.3931" x2="1452.3931" y1="991.6719" y2="991.6719"/><line style="stroke:#181818;stroke-width:1;" x1="1452.3931" x2="1452.3931" y1="991.6719" y2="1004.6719"/><line style="stroke:#181818;stroke-width:1;" x1="1411.3931" x2="1452.3931" y1="1004.6719" y2="1004.6719"/><polygon fill="#181818" points="1421.3931,1000.6719,1411.3931,1004.6719,1421.3931,1008.6719,1417.3931,1004.6719" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.8647" x="1417.3931" y="971.6191">receive CallRequested</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.6689" x="1417.3931" y="986.9297">for requestId</text><line style="stroke:#181818;stroke-width:1;" x1="1410.3931" x2="1452.3931" y1="1033.9824" y2="1033.9824"/><line style="stroke:#181818;stroke-width:1;" x1="1452.3931" x2="1452.3931" y1="1033.9824" y2="1046.9824"/><line style="stroke:#181818;stroke-width:1;" x1="1411.3931" x2="1452.3931" y1="1046.9824" y2="1046.9824"/><polygon fill="#181818" points="1421.3931,1042.9824,1411.3931,1046.9824,1421.3931,1050.9824,1417.3931,1046.9824" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253.8872" x="1417.3931" y="1029.2402">decrypt encArgs.ciphertext -&gt; argsPlain</text><line style="stroke:#181818;stroke-width:1;" x1="1410.3931" x2="1452.3931" y1="1076.293" y2="1076.293"/><line style="stroke:#181818;stroke-width:1;" x1="1452.3931" x2="1452.3931" y1="1076.293" y2="1089.293"/><line style="stroke:#181818;stroke-width:1;" x1="1411.3931" x2="1452.3931" y1="1089.293" y2="1089.293"/><polygon fill="#181818" points="1421.3931,1085.293,1411.3931,1089.293,1421.3931,1093.293,1417.3931,1089.293" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.0293" x="1417.3931" y="1071.5508">require keccak256(argsPlain) == argsHash</text><polygon fill="#181818" points="1060.6733,1114.6035,1050.6733,1118.6035,1060.6733,1122.6035,1056.6733,1118.6035" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1054.6733" x2="1399.3931" y1="1118.6035" y2="1118.6035"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.6807" x="1066.6733" y="1113.8613">fulfillCall(requestId, argsPlain)</text><polygon fill="#181818" points="1677.4224,1143.9141,1687.4224,1147.9141,1677.4224,1151.9141,1681.4224,1147.9141" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1049.6733" x2="1683.4224" y1="1147.9141" y2="1147.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.2983" x="1056.6733" y="1143.1719">call selector(clientId, argsPlain)</text><line style="stroke:#181818;stroke-width:1;" x1="1699.4224" x2="1741.4224" y1="1207.8457" y2="1207.8457"/><line style="stroke:#181818;stroke-width:1;" x1="1741.4224" x2="1741.4224" y1="1207.8457" y2="1220.8457"/><line style="stroke:#181818;stroke-width:1;" x1="1700.4224" x2="1741.4224" y1="1220.8457" y2="1220.8457"/><polygon fill="#181818" points="1710.4224,1216.8457,1700.4224,1220.8457,1710.4224,1224.8457,1706.4224,1220.8457" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235.0474" x="1706.4224" y="1172.4824">stored = argsHashByClientId[clientId]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.1094" x="1706.4224" y="1187.793">computed = keccak256(argsPlain)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.0181" x="1706.4224" y="1203.1035">require(computed == stored)</text><polygon fill="#181818" points="1060.6733,1246.1563,1050.6733,1250.1563,1060.6733,1254.1563,1056.6733,1250.1563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1054.6733" x2="1688.4224" y1="1250.1563" y2="1250.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.6523" x="1066.6733" y="1245.4141">returnData / events</text><line style="stroke:#181818;stroke-width:1;" x1="1049.6733" x2="1091.6733" y1="1279.4668" y2="1279.4668"/><line style="stroke:#181818;stroke-width:1;" x1="1091.6733" x2="1091.6733" y1="1279.4668" y2="1292.4668"/><line style="stroke:#181818;stroke-width:1;" x1="1050.6733" x2="1091.6733" y1="1292.4668" y2="1292.4668"/><polygon fill="#181818" points="1060.6733,1288.4668,1050.6733,1292.4668,1060.6733,1296.4668,1056.6733,1292.4668" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.8013" x="1056.6733" y="1274.7246">emit CallFulfilled(requestId, success, returnData)</text><polygon fill="#181818" points="1393.3931,1317.7773,1403.3931,1321.7773,1393.3931,1325.7773,1397.3931,1321.7773" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1049.6733" x2="1399.3931" y1="1321.7773" y2="1321.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.2202" x="1056.6733" y="1317.0352">CallFulfilled event</text><!--SRC=[jLLjRzis4FwkNt5hWLR276yOi64mu0ABsg31XdcedKzDFz3aMIOYKof9kV5-_OuKgJV7MO6Y3X08vDrpTyyzT_oXrgmuCB1O_GjMDvWaLjeIOQEPCZNJg2pah2pXBHgkPMqh3J_2EyNrgROeu0zTD0SoCd2KB5hwIrafM6d62IozLT8wjqVaZR-ezyoWcO51Yi4iWcMwG9ib2UCkn1qm0o_k36huoQEYVf6GgPLSrenoMdk3l9G-mKfPYcJlLNhT6AdG6FYhAYGdvpN1iGApUtL5Fx9WwWGyE6HZqBm5VRg8FaY4kdMMlM5hDqPSFOFO0wNLRdV5zqogIK8Rxxxnt7nJbSbhe7FmVV3SBw10XPvwx9h9kcOo9S0G9ZLcZmVdcnIwQke10bmz1K4t-o7ImjsHI5f8EZRloI81-hqcO_u0gMWEXnCSg1og06n57gMh6BPLeuHK1NqyPjxb5GdZwkFB6__xz0PMYJ-cmpVqRm7RHfPYuSFyKnATaEAyc0FRoZcbKGbCv_DvHYpnwb0t5XTTHh241-ISFVpowszfvq-M0JBgt7MndG9sThAaSAKivBR4LhAp3WYpFj4LB29XYtwItdlY-d6Aj2tXtTzvwYeGw2iuYvkrsDHeUNJDMC7BttzsV_vuHSrhoOc8QQnv1dMpBIN_4q-tOWQakJrgYu-s1HJOGmvuNXEKQRO7QRlSkwpJ46EIqHgePNaUCbftA5vWmMNUX_TIYSSnMTAqx-Ns19KMVY_KkgehmqgG8el8eLOIbgg-b2WAT8cHiSOTqZRZEArjdQ0ISK0c6sem9Tol6iUJrR8eA07H3xHFsBlYO5OcOCE1-Lgqxp4eZdfQ3KAwO7Ure7pyM119H3vgHOo6hBwgZG8jSbeA6ZjKCCnAivCeOjlS1ZIoKCms6Wt5f_dWRc6uIMguTw8-P6FeCxxwwmrTQooaeOnx_VMyJlKpaUJ6rT8DoIOYHklhKnwGFaR8JpIAKz3e7DBz4F91CKXadC10U9jaN2onP-W9vks3sx-tZiBnMWclPNmGAB6DUqeTenNTdiUUmP6LKjmfAylhik8FsI1sxfdytA2n3Z_be-WTanC2ytRBtDpuutm896cgno3pVirU8B43Q9T2ZQsWGrv4GVXoLOLFHyGuJ1QX0gETJn_27IFjBi_nXm0alFwd_SdFDqNSgEqI9y6ZFE8OwbxjIDBZo9TNSmiKPl-fLKWMtICoZTuo_TIpvMWUqRkAzEwQSYVBqZTwG6dlUc7rFzTtDpZS3tYGu4Jz0-3_cp_VVG7BPmUnUxx5nLSxa9FsXik0dGrcjXKiRIJrbbdczj_HRP4BWzf9jDFFJKicwMT0fMaufnKz6o0FTUbQD_9jWvwBpxrA_m40]--></g></svg>