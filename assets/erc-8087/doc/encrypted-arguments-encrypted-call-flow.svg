<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1597px" preserveAspectRatio="none" style="width:1942px;height:1597px;background:#FFFFFF;" version="1.1" viewBox="0 0 1942 1597" width="1942px" zoomAndPan="magnify"><title>Encrypted Call Descriptor + Encrypted Arguments via Call Decryption Oracle (Init + Execution phases, separate target)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="855.9756" x="537.9783" y="28.5352">Encrypted Call Descriptor + Encrypted Arguments via Call Decryption Oracle (Init + Execution phases, separate target)</text><g><title>User . Caller</title><rect fill="#000000" fill-opacity="0.00000" height="1396.6641" width="8" x="47.3032" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="50.8032" x2="50.8032" y1="118.9766" y2="1515.6406"/></g><g><title>Client Contract</title><rect fill="#000000" fill-opacity="0.00000" height="1396.6641" width="8" x="525.082" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="528.582" x2="528.582" y1="118.9766" y2="1515.6406"/></g><g><title/><rect fill="#FFCC80" height="86.9316" style="stroke:#181818;stroke-width:1;" width="10" x="523.582" y="325.1504"/></g><g><title/><rect fill="#FFCC80" height="71.6211" style="stroke:#181818;stroke-width:1;" width="10" x="523.582" y="515.3242"/></g><g><title/><rect fill="#FFCC80" height="375.7266" style="stroke:#181818;stroke-width:1;" width="10" x="523.582" y="675.5664"/></g><g><title>Call Decryption Oracle Contract</title><rect fill="#000000" fill-opacity="0.00000" height="1396.6641" width="8" x="844.9229" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="848.4229" x2="848.4229" y1="118.9766" y2="1515.6406"/></g><g><title/><rect fill="#8080FF" height="116.2422" style="stroke:#181818;stroke-width:1;" width="10" x="843.4229" y="935.0508"/></g><g><title/><rect fill="#8080FF" height="203.1738" style="stroke:#181818;stroke-width:1;" width="10" x="843.4229" y="1280.4668"/></g><g><title>Call Decryption Oracle</title><rect fill="#000000" fill-opacity="0.00000" height="1396.6641" width="8" x="1226.2285" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1229.7285" x2="1229.7285" y1="118.9766" y2="1515.6406"/></g><g><title/><rect fill="#808080" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1224.7285" y="266.5293"/></g><g><title/><rect fill="#808080" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1224.7285" y="456.7031"/></g><g><title/><rect fill="#808080" height="171.5527" style="stroke:#181818;stroke-width:1;" width="10" x="1224.7285" y="1108.9141"/></g><g><title>Target Contract</title><rect fill="#000000" fill-opacity="0.00000" height="1396.6641" width="8" x="1571.8408" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1575.3408" x2="1575.3408" y1="118.9766" y2="1515.6406"/></g><g><title/><rect fill="#FF8080" height="71.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1570.3408" y="804.8086"/></g><g><title/><rect fill="#FF8080" height="102.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1570.3408" y="1309.7773"/></g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85.6064" x="5" y="116.0234">User / Caller</text><ellipse cx="50.8032" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M50.8032,58.9883 L50.8032,85.9883 M37.8032,66.9883 L63.8032,66.9883 M50.8032,85.9883 L37.8032,100.9883 M50.8032,85.9883 L63.8032,100.9883" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="189.7998" x="433.6821" y="44.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102.0127" x="477.5757" y="65.0469">Client Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175.7998" x="440.6821" y="81.5352">(Business Logic / Storage)</text><line style="stroke:#181818;stroke-width:1;" x1="433.6821" x2="623.4819" y1="89.4883" y2="89.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.832" x="482.166" y="108.0234">(any contract)</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="228.1152" x="734.3652" y="44.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="214.1152" x="741.3652" y="65.0469">Call Decryption Oracle Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="846.208" y="81.5352">&#160;</text><line style="stroke:#181818;stroke-width:1;" x1="734.3652" x2="962.4805" y1="89.4883" y2="89.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146.7813" x="775.0322" y="108.0234">ICallDecryptionOracle</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165.6074" x="1146.9248" y="44.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.6074" x="1153.9248" y="65.0469">Call Decryption Oracle</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1227.5137" y="81.5352">&#160;</text><line style="stroke:#181818;stroke-width:1;" x1="1146.9248" x2="1312.5322" y1="89.4883" y2="89.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.4268" x="1193.5151" y="108.0234">(off-chain)</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="189.7998" x="1480.4409" y="44.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.5859" x="1522.0479" y="65.0469">Target Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175.7998" x="1487.4409" y="81.5352">(Business Logic / Storage)</text><line style="stroke:#181818;stroke-width:1;" x1="1480.4409" x2="1670.2407" y1="89.4883" y2="89.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.832" x="1528.9248" y="108.0234">(any contract)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85.6064" x="5" y="1589.1758">User / Caller</text><ellipse cx="50.8032" cy="1524.1406" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M50.8032,1532.1406 L50.8032,1559.1406 M37.8032,1540.1406 L63.8032,1540.1406 M50.8032,1559.1406 L37.8032,1574.1406 M50.8032,1559.1406 L63.8032,1574.1406" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="189.7998" x="433.6821" y="1515.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102.0127" x="477.5757" y="1536.1758">Client Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175.7998" x="440.6821" y="1552.6641">(Business Logic / Storage)</text><line style="stroke:#181818;stroke-width:1;" x1="433.6821" x2="623.4819" y1="1560.6172" y2="1560.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.832" x="482.166" y="1579.1523">(any contract)</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="228.1152" x="734.3652" y="1515.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="214.1152" x="741.3652" y="1536.1758">Call Decryption Oracle Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="846.208" y="1552.6641">&#160;</text><line style="stroke:#181818;stroke-width:1;" x1="734.3652" x2="962.4805" y1="1560.6172" y2="1560.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146.7813" x="775.0322" y="1579.1523">ICallDecryptionOracle</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165.6074" x="1146.9248" y="1515.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.6074" x="1153.9248" y="1536.1758">Call Decryption Oracle</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1227.5137" y="1552.6641">&#160;</text><line style="stroke:#181818;stroke-width:1;" x1="1146.9248" x2="1312.5322" y1="1560.6172" y2="1560.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.4268" x="1193.5151" y="1579.1523">(off-chain)</text><rect fill="#E2E2F0" height="73.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="189.7998" x="1480.4409" y="1515.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.5859" x="1522.0479" y="1536.1758">Target Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175.7998" x="1487.4409" y="1552.6641">(Business Logic / Storage)</text><line style="stroke:#181818;stroke-width:1;" x1="1480.4409" x2="1670.2407" y1="1560.6172" y2="1560.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.832" x="1528.9248" y="1579.1523">(any contract)</text><path d="M34.8032,130.9766 L580.2207,130.9766 L580.2207,138.2871 L570.2207,148.2871 L34.8032,148.2871 L34.8032,130.9766" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="463.9688" style="stroke:#000000;stroke-width:1.5;" width="1215.9253" x="34.8032" y="130.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="500.4175" x="49.8032" y="144.5449">Init phase - generate encrypted hashed arguments: encArgs and argsHash</text><polygon fill="#FFFFFF" points="1217.7285,160.2871,1227.7285,164.2871,1217.7285,168.2871,1221.7285,164.2871" style="stroke:#FFFFFF;stroke-width:1;"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="50.8032" x2="1223.7285" y1="164.2871" y2="164.2871"/><line style="stroke:#181818;stroke-width:1;" x1="50.8032" x2="92.8032" y1="224.2188" y2="224.2188"/><line style="stroke:#181818;stroke-width:1;" x1="92.8032" x2="92.8032" y1="224.2188" y2="237.2188"/><line style="stroke:#181818;stroke-width:1;" x1="51.8032" x2="92.8032" y1="237.2188" y2="237.2188"/><polygon fill="#181818" points="61.8032,233.2188,51.8032,237.2188,61.8032,241.2188,57.8032,237.2188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.0176" x="57.8032" y="188.8555">build: argsPlain (e.g. abi.encode(...))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.8125" x="57.8032" y="204.166">compute: argsHash = keccak256(argsPlain)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="463.7788" x="57.8032" y="219.4766">build: ArgumentDecriptor argumentDecriptor = (eligibleCaller,argsPlaine)</text><polygon fill="#181818" points="1212.7285,262.5293,1222.7285,266.5293,1212.7285,270.5293,1216.7285,266.5293" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="50.8032" x2="1218.7285" y1="266.5293" y2="266.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="538.9478" x="57.8032" y="261.7871">encrypt: EncryptedHashedArguments encArgs = ENC(abi.decode(argumentDecriptor))</text><polygon fill="#181818" points="61.8032,291.8398,51.8032,295.8398,61.8032,299.8398,57.8032,295.8398" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="55.8032" x2="1223.7285" y1="295.8398" y2="295.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.8945" x="67.8032" y="291.0977">encArgs (argsHash, publicKeyId, ciphertext)</text><polygon fill="#181818" points="511.582,321.1504,521.582,325.1504,511.582,329.1504,515.582,325.1504" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="50.8032" x2="517.582" y1="325.1504" y2="325.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.8315" x="57.8032" y="320.4082">submitEncryptedArguments(encArgs)</text><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="575.582" y1="369.7715" y2="369.7715"/><line style="stroke:#181818;stroke-width:1;" x1="575.582" x2="575.582" y1="369.7715" y2="382.7715"/><line style="stroke:#181818;stroke-width:1;" x1="534.582" x2="575.582" y1="382.7715" y2="382.7715"/><polygon fill="#181818" points="544.582,378.7715,534.582,382.7715,544.582,386.7715,540.582,382.7715" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300.8408" x="540.582" y="349.7188">store encArgs.ciphertext and encArgs.argsHash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.5952" x="540.582" y="365.0293">(e.g. by order / proposal id)</text><polygon fill="#181818" points="61.8032,408.082,51.8032,412.082,61.8032,416.082,57.8032,412.082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="55.8032" x2="522.582" y1="412.082" y2="412.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.5063" x="67.8032" y="407.3398">acknowledgement / reference</text><polygon fill="#181818" points="1212.7285,452.7031,1222.7285,456.7031,1212.7285,460.7031,1216.7285,456.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="50.8032" x2="1218.7285" y1="456.7031" y2="456.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.6235" x="57.8032" y="436.6504">build CallDescriptor(clientId, argsHash, ...)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.2563" x="57.8032" y="451.9609">and encrypt -&gt; EncryptedCallDescriptor encCall</text><polygon fill="#181818" points="61.8032,482.0137,51.8032,486.0137,61.8032,490.0137,57.8032,486.0137" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="55.8032" x2="1223.7285" y1="486.0137" y2="486.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.6587" x="67.8032" y="481.2715">encCall</text><polygon fill="#181818" points="511.582,511.3242,521.582,515.3242,511.582,519.3242,515.582,515.3242" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="50.8032" x2="517.582" y1="515.3242" y2="515.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.1885" x="57.8032" y="510.582">store encrypted call descriptor encCall</text><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="575.582" y1="544.6348" y2="544.6348"/><line style="stroke:#181818;stroke-width:1;" x1="575.582" x2="575.582" y1="544.6348" y2="557.6348"/><line style="stroke:#181818;stroke-width:1;" x1="534.582" x2="575.582" y1="557.6348" y2="557.6348"/><polygon fill="#181818" points="544.582,553.6348,534.582,557.6348,544.582,561.6348,540.582,557.6348" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.8086" x="540.582" y="539.8926">store encCall</text><polygon fill="#181818" points="61.8032,582.9453,51.8032,586.9453,61.8032,590.9453,57.8032,586.9453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="55.8032" x2="522.582" y1="586.9453" y2="586.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.5063" x="67.8032" y="582.2031">acknowledgement / reference</text><path d="M34.8032,612.9453 L532.4863,612.9453 L532.4863,620.2559 L522.4863,630.2559 L34.8032,630.2559 L34.8032,612.9453" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="878.6953" style="stroke:#000000;stroke-width:1.5;" width="1884.1289" x="34.8032" y="612.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="452.6831" x="49.8032" y="626.5137">Execution phase - generate clientId, trigger decryption and execute</text><polygon fill="#FFFFFF" points="1217.7285,642.2559,1227.7285,646.2559,1217.7285,650.2559,1221.7285,646.2559" style="stroke:#FFFFFF;stroke-width:1;"/><line style="stroke:#FFFFFF;stroke-width:1;" x1="50.8032" x2="1223.7285" y1="646.2559" y2="646.2559"/><polygon fill="#181818" points="511.582,671.5664,521.582,675.5664,511.582,679.5664,515.582,675.5664" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="50.8032" x2="517.582" y1="675.5664" y2="675.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.291" x="57.8032" y="670.8242">conditionUpdate(...) / external trigger</text><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="575.582" y1="720.1875" y2="720.1875"/><line style="stroke:#181818;stroke-width:1;" x1="575.582" x2="575.582" y1="720.1875" y2="733.1875"/><line style="stroke:#181818;stroke-width:1;" x1="534.582" x2="575.582" y1="733.1875" y2="733.1875"/><polygon fill="#181818" points="544.582,729.1875,534.582,733.1875,544.582,737.1875,540.582,733.1875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.3623" x="540.582" y="700.1348">detect precondition satisfied</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.9863" x="540.582" y="715.4453">(e.g. all signatures collected or auction end)</text><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="575.582" y1="762.498" y2="762.498"/><line style="stroke:#181818;stroke-width:1;" x1="575.582" x2="575.582" y1="762.498" y2="775.498"/><line style="stroke:#181818;stroke-width:1;" x1="534.582" x2="575.582" y1="775.498" y2="775.498"/><polygon fill="#181818" points="544.582,771.498,534.582,775.498,544.582,779.498,540.582,775.498" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.6504" x="540.582" y="757.7559">generate clientId</text><polygon fill="#181818" points="1558.3408,800.8086,1568.3408,804.8086,1558.3408,808.8086,1562.3408,804.8086" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="1564.3408" y1="804.8086" y2="804.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.5947" x="540.582" y="800.0664">registerArguments(clientId, encArgs.argsHash)</text><line style="stroke:#181818;stroke-width:1;" x1="1580.3408" x2="1622.3408" y1="834.1191" y2="834.1191"/><line style="stroke:#181818;stroke-width:1;" x1="1622.3408" x2="1622.3408" y1="834.1191" y2="847.1191"/><line style="stroke:#181818;stroke-width:1;" x1="1581.3408" x2="1622.3408" y1="847.1191" y2="847.1191"/><polygon fill="#181818" points="1591.3408,843.1191,1581.3408,847.1191,1591.3408,851.1191,1587.3408,847.1191" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308.5913" x="1587.3408" y="829.377">argsHashByClientId[clientId] = encArgs.argsHash</text><polygon fill="#181818" points="544.582,872.4297,534.582,876.4297,544.582,880.4297,540.582,876.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="538.582" x2="1569.3408" y1="876.4297" y2="876.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.4175" x="550.582" y="871.6875">Registered(clientId, argsHash)</text><polygon fill="#181818" points="1915.9321,901.7402,1925.9321,905.7402,1915.9321,909.7402,1919.9321,905.7402" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="1921.9321" y1="905.7402" y2="905.7402"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.0024" x="540.582" y="900.998">use stored EncryptedCallDescriptor encCall.</text><polygon fill="#181818" points="831.4229,931.0508,841.4229,935.0508,831.4229,939.0508,835.4229,935.0508" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="533.582" x2="837.4229" y1="935.0508" y2="935.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246.9175" x="540.582" y="930.3086">requestEncryptedCall(encCall, encArgs)</text><line style="stroke:#181818;stroke-width:1;" x1="853.4229" x2="895.4229" y1="979.6719" y2="979.6719"/><line style="stroke:#181818;stroke-width:1;" x1="895.4229" x2="895.4229" y1="979.6719" y2="992.6719"/><line style="stroke:#181818;stroke-width:1;" x1="854.4229" x2="895.4229" y1="992.6719" y2="992.6719"/><polygon fill="#181818" points="864.4229,988.6719,854.4229,992.6719,864.4229,996.6719,860.4229,992.6719" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.4136" x="860.4229" y="959.6191">store pending request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.7104" x="860.4229" y="974.9297">(requestId, requester, argsHash, ...)</text><polygon fill="#181818" points="544.582,1017.9824,534.582,1021.9824,544.582,1025.9824,540.582,1021.9824" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="538.582" x2="842.4229" y1="1021.9824" y2="1021.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.4712" x="550.582" y="1017.2402">requestId</text><polygon fill="#181818" points="544.582,1047.293,534.582,1051.293,544.582,1055.293,540.582,1051.293" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="538.582" x2="842.4229" y1="1051.293" y2="1051.293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.8198" x="550.582" y="1046.5508">emit EncryptedCallRequested(...)</text><line style="stroke:#181818;stroke-width:1;" x1="1229.7285" x2="1276.7285" y1="1095.9141" y2="1095.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1276.7285" x2="1276.7285" y1="1095.9141" y2="1108.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1235.7285" x2="1276.7285" y1="1108.9141" y2="1108.9141"/><polygon fill="#181818" points="1245.7285,1104.9141,1235.7285,1108.9141,1245.7285,1112.9141,1241.7285,1108.9141" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.2178" x="1241.7285" y="1075.8613">receive EncryptedCallRequested</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.6689" x="1241.7285" y="1091.1719">for requestId</text><line style="stroke:#181818;stroke-width:1;" x1="1234.7285" x2="1276.7285" y1="1153.5352" y2="1153.5352"/><line style="stroke:#181818;stroke-width:1;" x1="1276.7285" x2="1276.7285" y1="1153.5352" y2="1166.5352"/><line style="stroke:#181818;stroke-width:1;" x1="1235.7285" x2="1276.7285" y1="1166.5352" y2="1166.5352"/><polygon fill="#181818" points="1245.7285,1162.5352,1235.7285,1166.5352,1245.7285,1170.5352,1241.7285,1166.5352" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.4209" x="1241.7285" y="1133.4824">decrypt encCall.ciphertext -&gt; callDescriptor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="326.6123" x="1241.7285" y="1148.793">(targetContract = T, selector, clientId, argsHash, ...)</text><line style="stroke:#181818;stroke-width:1;" x1="1234.7285" x2="1276.7285" y1="1195.8457" y2="1195.8457"/><line style="stroke:#181818;stroke-width:1;" x1="1276.7285" x2="1276.7285" y1="1195.8457" y2="1208.8457"/><line style="stroke:#181818;stroke-width:1;" x1="1235.7285" x2="1276.7285" y1="1208.8457" y2="1208.8457"/><polygon fill="#181818" points="1245.7285,1204.8457,1235.7285,1208.8457,1245.7285,1212.8457,1241.7285,1208.8457" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253.8872" x="1241.7285" y="1191.1035">decrypt encArgs.ciphertext -&gt; argsPlain</text><line style="stroke:#181818;stroke-width:1;" x1="1234.7285" x2="1276.7285" y1="1238.1563" y2="1238.1563"/><line style="stroke:#181818;stroke-width:1;" x1="1276.7285" x2="1276.7285" y1="1238.1563" y2="1251.1563"/><line style="stroke:#181818;stroke-width:1;" x1="1235.7285" x2="1276.7285" y1="1251.1563" y2="1251.1563"/><polygon fill="#181818" points="1245.7285,1247.1563,1235.7285,1251.1563,1245.7285,1255.1563,1241.7285,1251.1563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.0293" x="1241.7285" y="1233.4141">require keccak256(argsPlain) == argsHash</text><polygon fill="#181818" points="864.4229,1276.4668,854.4229,1280.4668,864.4229,1284.4668,860.4229,1280.4668" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="858.4229" x2="1223.7285" y1="1280.4668" y2="1280.4668"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.3057" x="870.4229" y="1275.7246">fulfillEncryptedCall(requestId, callDescriptor, argsPlain)</text><polygon fill="#181818" points="1558.3408,1305.7773,1568.3408,1309.7773,1558.3408,1313.7773,1562.3408,1309.7773" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="853.4229" x2="1564.3408" y1="1309.7773" y2="1309.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.2983" x="860.4229" y="1305.0352">call selector(clientId, argsPlain)</text><line style="stroke:#181818;stroke-width:1;" x1="1580.3408" x2="1622.3408" y1="1369.709" y2="1369.709"/><line style="stroke:#181818;stroke-width:1;" x1="1622.3408" x2="1622.3408" y1="1369.709" y2="1382.709"/><line style="stroke:#181818;stroke-width:1;" x1="1581.3408" x2="1622.3408" y1="1382.709" y2="1382.709"/><polygon fill="#181818" points="1591.3408,1378.709,1581.3408,1382.709,1591.3408,1386.709,1587.3408,1382.709" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235.0474" x="1587.3408" y="1334.3457">stored = argsHashByClientId[clientId]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.1094" x="1587.3408" y="1349.6563">computed = keccak256(argsPlain)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.0181" x="1587.3408" y="1364.9668">require(computed == stored)</text><polygon fill="#181818" points="864.4229,1408.0195,854.4229,1412.0195,864.4229,1416.0195,860.4229,1412.0195" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="858.4229" x2="1569.3408" y1="1412.0195" y2="1412.0195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.6523" x="870.4229" y="1407.2773">returnData / events</text><line style="stroke:#181818;stroke-width:1;" x1="853.4229" x2="895.4229" y1="1441.3301" y2="1441.3301"/><line style="stroke:#181818;stroke-width:1;" x1="895.4229" x2="895.4229" y1="1441.3301" y2="1454.3301"/><line style="stroke:#181818;stroke-width:1;" x1="854.4229" x2="895.4229" y1="1454.3301" y2="1454.3301"/><polygon fill="#181818" points="864.4229,1450.3301,854.4229,1454.3301,864.4229,1458.3301,860.4229,1454.3301" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.8013" x="860.4229" y="1436.5879">emit CallFulfilled(requestId, success, returnData)</text><polygon fill="#181818" points="1217.7285,1479.6406,1227.7285,1483.6406,1217.7285,1487.6406,1221.7285,1483.6406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="853.4229" x2="1223.7285" y1="1483.6406" y2="1483.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.2202" x="860.4229" y="1478.8984">CallFulfilled event</text><!--SRC=[jLPjRzis4FwkNt5hWLN276yOq64mu0ABsg31XhcedKzDFz3YMI4YKof9PV5-_OuKIRtOJe8DSu10eEwUktlkxg6-QnGhzmmCrd-3KIqcYH6cGlWW2tLe37B8MLN1UzI54esf5VmmUFURAjizIgFXGR1WwLwAMi9AiOAWqcifZ7LxnA9rBvexfb7FG6F353C8XgaIJPOahB0XRe1fU7MZKS6F3XNLguHCZIX4mwI1jJF8Aq6n8Q-beKZcLgQNhHOIjOO_wb8KvBmcE5PYTYilw4SMJ1wWy0xP63JlG4yNqGS9KDVMiZVixCQ8goSGUw2qtkqkYZicv2IXZNFVE6x-KvN96w1pS7rmt2-WH8cEUepDPB6PJ7BGX4cDkSEzzKrALRVD004kJa7GcxiXqiA-eo7f8EbOVoIB1EZtXeoBUqXvkzyVO4_bK0LWQlAeRCMmhLl9XIpfuJ5pBj_JO5nyUNtbVb_VmIfnntJuZlujODkAYYzSc4yLqGafpiiviAsOKnerntG-dsV4Kb7lczRW8cO4IxZ7ec3tFx_z9Ot-PEaXmvpRBdPRm8vEbXIk4gNOLjYDx2m2OTOdke9586pHRz97Hro_Je6s9NpuCqzj1HnT1KTnimwR6YqUR3DMyFhNd-oVErvHypfo0c8QQfv1qsuhKVoEXsi-0vgvErG67qq7oB677F2y9YZTRlV2nDnZrgcFCSbe3TIoFFSPhIEA6p3lCk_3kr49no5PccdNo-q1QiMTBZIgRchDAX0y2yY-LXeiMVzL8I_H9aR62dUe21IdjQqJFusNjjCXjYqCklsEkXUt55AD5LgX8jQS15d-Ubhja8txxQPeWfUUSxsLmoG88H8zIOXCxCcBsn-DdsfjQ8fVwC9g5tycvdCDZXx_jaCeUT2moIKo4BAUJwD4MTACy5vp7QNE5GToDW4RQjfBqVuFBRFaaNfpOOFTD9poSSf5BD5-e98qz3wh5pM2ew5nfON1Y0gQ6Q5t0ddOBDjeBKh9JAjGK_pApZYDW1Mxjd1Er8Ti37t4L_zwGwyLba9Jnhr4zBnELtoY6XjRInpaJK0CrfU7t2Dz2P1VIIsdeC7Pf_lPvuFynFeTwTucwQjPG4i3uaQQFxUHyu5VxbZurg8s8w_KsqOU9kNdtHvVNRdZF41rEzLWDqqUc5hedsmv_f7kdrEQb4SkeaiVmHuZIVkumCyUaASHPK1IVaPHLq7yQEfGFE0Pp5kv8-B6kPmNimxHRsAaUt1ta4KnwWbnqtrSXkyd6fAD_V9yaOAV2ZczhiWYNlJJoh-rWjfrwjC2bilnzz0gj7ZNLZjHLUDf6VHtND-i3txktdvgfknAEOqFX4psOW3yt6RwtLW-kQBnsukV_UJohAMzuT9ZPuDjxlQAj4g-PuPPPNom-d9cXUF-kEcsZ5vrBDDG3wZLRL6GUCy6oCEjiJqT-NP1ZpV2tbV_0000]--></g></svg>