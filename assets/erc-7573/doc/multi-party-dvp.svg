<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2283px" preserveAspectRatio="none" style="width:1641px;height:2283px;background:#FFFFFF;" version="1.1" viewBox="0 0 1641 2283" width="1641px" zoomAndPan="magnify"><title>Multi-Party Multi-Asset Multi-Chain DvP</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="296.8848" x="673.3325" y="28.5352">Multi-Party Multi-Asset Multi-Chain DvP</text><g><title>..Token 0.. .</title><rect fill="#80FF80" height="260.3965" style="stroke:#181818;stroke-width:1;" width="10" x="568.7686" y="1124.2891"/></g><g><title>..Token 0.. .</title><rect fill="#80FF80" height="279.707" style="stroke:#181818;stroke-width:1;" width="10" x="568.7686" y="1413.6406"/></g><g><title>..Token 0.. .</title><rect fill="#80FF80" height="279.707" style="stroke:#181818;stroke-width:1;" width="10" x="568.7686" y="1751.6133"/></g><g><title>..Token 0.. .</title><rect fill="#80FF80" height="15" style="stroke:#181818;stroke-width:1;" width="10" x="568.7686" y="2060.6309"/></g><g><title>..Token 1.. .</title><rect fill="#FF8080" height="71.6211" style="stroke:#181818;stroke-width:1;" width="10" x="826.7974" y="480.4121"/></g><g><title>..Token 2.. .</title><rect fill="#FF8080" height="71.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1019.4644" y="671.2754"/></g><g><title>..Token n.. .</title><rect fill="#FF8080" height="71.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1348.3911" y="938.6699"/></g><g><title>..Decryption Oracle.. .</title><rect fill="#8080FF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1540.9058" y="176.707"/></g><g><title>..Decryption Oracle.. .</title><rect fill="#8080FF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1540.9058" y="235.3281"/></g><g><title>..Decryption Oracle.. .</title><rect fill="#8080FF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1540.9058" y="1693.3477"/></g><g><title>..Decryption Oracle.. .</title><rect fill="#8080FF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1540.9058" y="2031.3203"/></g><rect fill="#F8F8F8" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="1624.5498" x="10" y="138.0859"/><rect fill="#F8F8FF" height="176.8633" style="stroke:#000000;stroke-width:1.5;" width="1014.4644" x="10" y="383.1699"/><rect fill="#F8F8FF" height="176.8633" style="stroke:#000000;stroke-width:1.5;" width="1207.1313" x="10" y="574.0332"/><rect fill="#F8F8FF" height="176.8633" style="stroke:#000000;stroke-width:1.5;" width="1535.9058" x="10" y="841.4277"/><rect fill="#F8F8F8" height="929.3418" style="stroke:#000000;stroke-width:1.5;" width="1624.5498" x="10" y="1139.2891"/><rect fill="#F8FFF8" height="337.9727" style="stroke:none;stroke-width:1;" width="1624.5498" x="10" y="1392.6855"/><rect fill="#FFF8F8" height="337.9727" style="stroke:none;stroke-width:1;" width="1624.5498" x="10" y="1730.6582"/><g><title>CP0</title><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="32.1387" y="121.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="36" x2="36" y1="121.0859" y2="2201.0059"/></g><g><title>CP1</title><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="74.416" y="121.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="78.2773" x2="78.2773" y1="121.0859" y2="2201.0059"/></g><g><title>CP2</title><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="116.6934" y="121.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="120.5547" x2="120.5547" y1="121.0859" y2="2201.0059"/></g><g><title>....</title><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="164.9668" y="121.0859"/><line style="stroke:#FFFFFF;stroke-width:0.5;stroke-dasharray:5,5;" x1="168.832" x2="168.832" y1="121.0859" y2="2201.0059"/></g><g><title>CPn</title><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="213.1582" y="121.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="217.1016" x2="217.1016" y1="121.0859" y2="2201.0059"/></g><g><title>..Token 0.. .</title><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="569.7686" y="121.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="573.4097" x2="573.4097" y1="121.0859" y2="2201.0059"/></g><g><title>..Token 1.. .</title><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="827.7974" y="121.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="831.3677" x2="831.3677" y1="121.0859" y2="2201.0059"/></g><g><title>..Token 2.. .</title><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="1020.4644" y="121.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1024.0347" x2="1024.0347" y1="121.0859" y2="2201.0059"/></g><g><title>....</title><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="1213.1313" y="121.0859"/><line style="stroke:#FFFFFF;stroke-width:0.5;stroke-dasharray:5,5;" x1="1216.9966" x2="1216.9966" y1="121.0859" y2="2201.0059"/></g><g><title/><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="1255.1138" y="121.0859"/><line style="stroke:#FFFFFF;stroke-width:0.5;stroke-dasharray:5,5;" x1="1258.2661" x2="1258.2661" y1="121.0859" y2="2201.0059"/></g><g><title>..Token n.. .</title><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="1349.3911" y="121.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1352.9614" x2="1352.9614" y1="121.0859" y2="2201.0059"/></g><g><title>..Decryption Oracle.. .</title><rect fill="#000000" fill-opacity="0.00000" height="2079.9199" width="8" x="1541.9058" y="121.0859"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1545.2617" x2="1545.2617" y1="121.0859" y2="2201.0059"/></g><g class="participant participant-head" data-participant="CP0"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.2773" x="20" y="118.1328">CP0</text><ellipse cx="36.1387" cy="53.0977" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M36.1387,61.0977 L36.1387,88.0977 M23.1387,69.0977 L49.1387,69.0977 M36.1387,88.0977 L23.1387,103.0977 M36.1387,88.0977 L49.1387,103.0977" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="CP0"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.2773" x="20" y="2213.541">CP0</text><ellipse cx="36.1387" cy="2224.9941" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M36.1387,2232.9941 L36.1387,2259.9941 M23.1387,2240.9941 L49.1387,2240.9941 M36.1387,2259.9941 L23.1387,2274.9941 M36.1387,2259.9941 L49.1387,2274.9941" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="CP1"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.2773" x="62.2773" y="118.1328">CP1</text><ellipse cx="78.416" cy="53.0977" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M78.416,61.0977 L78.416,88.0977 M65.416,69.0977 L91.416,69.0977 M78.416,88.0977 L65.416,103.0977 M78.416,88.0977 L91.416,103.0977" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="CP1"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.2773" x="62.2773" y="2213.541">CP1</text><ellipse cx="78.416" cy="2224.9941" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M78.416,2232.9941 L78.416,2259.9941 M65.416,2240.9941 L91.416,2240.9941 M78.416,2259.9941 L65.416,2274.9941 M78.416,2259.9941 L91.416,2274.9941" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="CP2"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.2773" x="104.5547" y="118.1328">CP2</text><ellipse cx="120.6934" cy="53.0977" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M120.6934,61.0977 L120.6934,88.0977 M107.6934,69.0977 L133.6934,69.0977 M120.6934,88.0977 L107.6934,103.0977 M120.6934,88.0977 L133.6934,103.0977" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="CP2"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.2773" x="104.5547" y="2213.541">CP2</text><ellipse cx="120.6934" cy="2224.9941" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M120.6934,2232.9941 L120.6934,2259.9941 M107.6934,2240.9941 L133.6934,2240.9941 M120.6934,2259.9941 L107.6934,2274.9941 M120.6934,2259.9941 L133.6934,2274.9941" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="spacer0"><rect fill="#FFFFFF" height="77.5977" rx="2.5" ry="2.5" style="stroke:#FFFFFF;stroke-width:0.5;" width="44.2695" x="146.832" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="166.1191" y="66.8906">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="30.2695" x="153.832" y="88.0898">&#8226;&#8226;&#8226;</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="166.1191" y="109.2891">&#160;</text></g><g class="participant participant-tail" data-participant="spacer0"><rect fill="#FFFFFF" height="77.5977" rx="2.5" ry="2.5" style="stroke:#FFFFFF;stroke-width:0.5;" width="44.2695" x="146.832" y="2200.0059"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="166.1191" y="2224.4082">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="30.2695" x="153.832" y="2245.6074">&#8226;&#8226;&#8226;</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="166.1191" y="2266.8066">&#160;</text></g><g class="participant participant-head" data-participant="CPn"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.1133" x="201.1016" y="118.1328">CPn</text><ellipse cx="217.1582" cy="53.0977" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M217.1582,61.0977 L217.1582,88.0977 M204.1582,69.0977 L230.1582,69.0977 M217.1582,88.0977 L204.1582,103.0977 M217.1582,88.0977 L230.1582,103.0977" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="CPn"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.1133" x="201.1016" y="2213.541">CPn</text><ellipse cx="217.1582" cy="2224.9941" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M217.1582,2232.9941 L217.1582,2259.9941 M204.1582,2240.9941 L230.1582,2240.9941 M217.1582,2259.9941 L204.1582,2274.9941 M217.1582,2259.9941 L230.1582,2274.9941" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="MPDvP"><rect fill="#E2E2F0" height="73.082" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="224.7178" x="461.4097" y="47.0039"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58.707" x="539.9854" y="67.5391">Token 0</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="603.1221" y="67.5391">:</text><line style="stroke:#181818;stroke-width:1;" x1="461.4097" x2="686.1274" y1="75.4922" y2="75.4922"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="160.1455" x="493.6958" y="93.4873">IDecryptionContract</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="210.7178" x="468.4097" y="109.7842">IDecryptionOracleCallback</text></g><g class="participant participant-tail" data-participant="MPDvP"><rect fill="#E2E2F0" height="73.082" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="224.7178" x="461.4097" y="2200.0059"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58.707" x="539.9854" y="2220.541">Token 0</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="603.1221" y="2220.541">:</text><line style="stroke:#181818;stroke-width:1;" x1="461.4097" x2="686.1274" y1="2228.4941" y2="2228.4941"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="160.1455" x="493.6958" y="2246.4893">IDecryptionContract</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="210.7178" x="468.4097" y="2262.7861">IDecryptionOracleCallback</text></g><g class="participant participant-head" data-participant="A_1_0"><rect fill="#E2E2F0" height="73.2734" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148.8594" x="757.3677" y="46.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58.707" x="798.0142" y="67.3477">Token 1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="861.1509" y="67.3477">:</text><line style="stroke:#181818;stroke-width:1;" x1="757.3677" x2="906.2271" y1="75.3008" y2="75.3008"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="134.8594" x="764.3677" y="93.2959">ILockingContract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="829.5825" y="110.1328">&#160;</text></g><g class="participant participant-tail" data-participant="A_1_0"><rect fill="#E2E2F0" height="73.2734" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148.8594" x="757.3677" y="2200.0059"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58.707" x="798.0142" y="2220.541">Token 1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="861.1509" y="2220.541">:</text><line style="stroke:#181818;stroke-width:1;" x1="757.3677" x2="906.2271" y1="2228.4941" y2="2228.4941"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="134.8594" x="764.3677" y="2246.4893">ILockingContract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="829.5825" y="2263.3262">&#160;</text></g><g class="participant participant-head" data-participant="A_0_2"><rect fill="#E2E2F0" height="73.2734" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148.8594" x="950.0347" y="46.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58.707" x="990.6812" y="67.3477">Token 2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1053.8179" y="67.3477">:</text><line style="stroke:#181818;stroke-width:1;" x1="950.0347" x2="1098.894" y1="75.3008" y2="75.3008"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="134.8594" x="957.0347" y="93.2959">ILockingContract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1022.2495" y="110.1328">&#160;</text></g><g class="participant participant-tail" data-participant="A_0_2"><rect fill="#E2E2F0" height="73.2734" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148.8594" x="950.0347" y="2200.0059"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58.707" x="990.6812" y="2220.541">Token 2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1053.8179" y="2220.541">:</text><line style="stroke:#181818;stroke-width:1;" x1="950.0347" x2="1098.894" y1="2228.4941" y2="2228.4941"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="134.8594" x="957.0347" y="2246.4893">ILockingContract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1022.2495" y="2263.3262">&#160;</text></g><g class="participant participant-head" data-participant="spacer1"><rect fill="#FFFFFF" height="77.5977" rx="2.5" ry="2.5" style="stroke:#FFFFFF;stroke-width:0.5;" width="44.2695" x="1194.9966" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="1214.2837" y="66.8906">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="30.2695" x="1201.9966" y="88.0898">&#8226;&#8226;&#8226;</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="1214.2837" y="109.2891">&#160;</text></g><g class="participant participant-tail" data-participant="spacer1"><rect fill="#FFFFFF" height="77.5977" rx="2.5" ry="2.5" style="stroke:#FFFFFF;stroke-width:0.5;" width="44.2695" x="1194.9966" y="2200.0059"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="1214.2837" y="2224.4082">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="30.2695" x="1201.9966" y="2245.6074">&#8226;&#8226;&#8226;</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="1214.2837" y="2266.8066">&#160;</text></g><g class="participant participant-head" data-participant="spacer2"><rect fill="#FFFFFF" height="56.3984" rx="2.5" ry="2.5" style="stroke:#FFFFFF;stroke-width:0.5;" width="19.6953" x="1249.2661" y="63.6875"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="1256.2661" y="88.0898">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="1256.2661" y="109.2891">&#160;</text></g><g class="participant participant-tail" data-participant="spacer2"><rect fill="#FFFFFF" height="56.3984" rx="2.5" ry="2.5" style="stroke:#FFFFFF;stroke-width:0.5;" width="19.6953" x="1249.2661" y="2200.0059"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="1256.2661" y="2224.4082">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="5.6953" x="1256.2661" y="2245.6074">&#160;</text></g><g class="participant participant-head" data-participant="A_0_n"><rect fill="#E2E2F0" height="73.2734" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148.8594" x="1278.9614" y="46.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58.666" x="1319.6284" y="67.3477">Token n</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1382.7241" y="67.3477">:</text><line style="stroke:#181818;stroke-width:1;" x1="1278.9614" x2="1427.8208" y1="75.3008" y2="75.3008"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="134.8594" x="1285.9614" y="93.2959">ILockingContract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1351.1763" y="110.1328">&#160;</text></g><g class="participant participant-tail" data-participant="A_0_n"><rect fill="#E2E2F0" height="73.2734" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148.8594" x="1278.9614" y="2200.0059"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58.666" x="1319.6284" y="2220.541">Token n</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1382.7241" y="2220.541">:</text><line style="stroke:#181818;stroke-width:1;" x1="1278.9614" x2="1427.8208" y1="2228.4941" y2="2228.4941"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="134.8594" x="1285.9614" y="2246.4893">ILockingContract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1351.1763" y="2263.3262">&#160;</text></g><g class="participant participant-head" data-participant="DecryptionOracle"><rect fill="#E2E2F0" height="73.2734" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="157.2881" x="1467.2617" y="46.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="129.8623" x="1476.5449" y="67.3477">Decryption Oracle</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1610.8369" y="67.3477">:</text><line style="stroke:#181818;stroke-width:1;" x1="1467.2617" x2="1624.5498" y1="75.3008" y2="75.3008"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="143.2881" x="1474.2617" y="93.2959">IDecryptionOracle</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1543.6909" y="110.1328">&#160;</text></g><g class="participant participant-tail" data-participant="DecryptionOracle"><rect fill="#E2E2F0" height="73.2734" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="157.2881" x="1467.2617" y="2200.0059"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="129.8623" x="1476.5449" y="2220.541">Decryption Oracle</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1610.8369" y="2220.541">:</text><line style="stroke:#181818;stroke-width:1;" x1="1467.2617" x2="1624.5498" y1="2228.4941" y2="2228.4941"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="143.2881" x="1474.2617" y="2246.4893">IDecryptionOracle</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1543.6909" y="2263.3262">&#160;</text></g><g><title>..Token 0.. .</title><rect fill="#80FF80" height="260.3965" style="stroke:#181818;stroke-width:1;" width="10" x="568.7686" y="1124.2891"/></g><g><title>..Token 0.. .</title><rect fill="#80FF80" height="279.707" style="stroke:#181818;stroke-width:1;" width="10" x="568.7686" y="1413.6406"/></g><g><title>..Token 0.. .</title><rect fill="#80FF80" height="279.707" style="stroke:#181818;stroke-width:1;" width="10" x="568.7686" y="1751.6133"/></g><g><title>..Token 0.. .</title><rect fill="#80FF80" height="15" style="stroke:#181818;stroke-width:1;" width="10" x="568.7686" y="2060.6309"/></g><g><title>..Token 1.. .</title><rect fill="#FF8080" height="71.6211" style="stroke:#181818;stroke-width:1;" width="10" x="826.7974" y="480.4121"/></g><g><title>..Token 2.. .</title><rect fill="#FF8080" height="71.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1019.4644" y="671.2754"/></g><g><title>..Token n.. .</title><rect fill="#FF8080" height="71.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1348.3911" y="938.6699"/></g><g><title>..Decryption Oracle.. .</title><rect fill="#8080FF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1540.9058" y="176.707"/></g><g><title>..Decryption Oracle.. .</title><rect fill="#8080FF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1540.9058" y="235.3281"/></g><g><title>..Decryption Oracle.. .</title><rect fill="#8080FF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1540.9058" y="1693.3477"/></g><g><title>..Decryption Oracle.. .</title><rect fill="#8080FF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="1540.9058" y="2031.3203"/></g><path d="M10,138.0859 L307.9985,138.0859 L307.9985,145.3965 L297.9985,155.3965 L10,155.3965 L10,138.0859" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="1624.5498" x="10" y="138.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="252.9985" x="25" y="151.6543">Generation of encrypted/hashed keys</text><g class="message" data-participant-1="CP0" data-participant-2="DecryptionOracle"><polygon fill="#181818" points="1528.9058,172.707,1538.9058,176.707,1528.9058,180.707,1532.9058,176.707" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="36.1387" x2="1534.9058" y1="176.707" y2="176.707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="43.1387" y="171.9648">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259.4858" x="78.2104" y="171.9648">requestEncryptedHashedKey(contract, id)</text></g><g class="message" data-participant-1="DecryptionOracle" data-participant-2="CP0"><polygon fill="#181818" points="47.1387,202.0176,37.1387,206.0176,47.1387,210.0176,43.1387,206.0176" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="41.1387" x2="1544.9058" y1="206.0176" y2="206.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="53.1387" y="201.2754">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.7388" x="88.2104" y="201.2754">E(S), H(S)</text></g><g class="message" data-participant-1="CP0" data-participant-2="DecryptionOracle"><polygon fill="#181818" points="1528.9058,231.3281,1538.9058,235.3281,1528.9058,239.3281,1532.9058,235.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="36.1387" x2="1534.9058" y1="235.3281" y2="235.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="43.1387" y="230.5859">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259.4858" x="78.2104" y="230.5859">requestEncryptedHashedKey(contract, id)</text></g><g class="message" data-participant-1="DecryptionOracle" data-participant-2="CP0"><polygon fill="#181818" points="47.1387,260.6387,37.1387,264.6387,47.1387,268.6387,43.1387,264.6387" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="41.1387" x2="1544.9058" y1="264.6387" y2="264.6387"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="53.1387" y="259.8965">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.6753" x="88.2104" y="259.8965">E(F), H(F)</text></g><path d="M41,284.6387 L41,331.6387 L1104,331.6387 L1104,294.6387 L1094,284.6387 L41,284.6387" fill="#FFFFFF"/><path d="M1094,284.6387 L1094,294.6387 L1104,294.6387 L1094,284.6387" fill="#FFFFFF"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="85.75" x="47" y="305.1074">Important:</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="951.6875" x="137.8125" y="305.1074">All parties CP0,&#8230;,CPn can observe that keys E(S), E(F) were generated by the trusted (on-chain) decryption oracle contract.</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="829.1016" x="47" y="323.9512">This ensures that no party knows neither the release key (success key, S) nor the revert key (failure key, F).</text><path d="M41,342.3262 L41,370.3262 L973,370.3262 L973,352.3262 L963,342.3262 L41,342.3262" fill="#FFFFFF"/><path d="M963,342.3262 L963,352.3262 L973,352.3262 L963,342.3262" fill="#FFFFFF"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="42.3281" x="47" y="362.7949">Note:</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="81.1797" x="94.3906" y="362.7949">The call to</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="148.6797" x="180.6328" y="362.7949">cancelAndDecrypt</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="624.6172" x="334.375" y="362.7949">is possible on MPDvP at any time, releasing failure key for all ILocking contracts.</text><path d="M10,383.1699 L481.499,383.1699 L481.499,390.4805 L471.499,400.4805 L10,400.4805 L10,383.1699" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="176.8633" style="stroke:#000000;stroke-width:1.5;" width="1014.4644" x="10" y="383.1699"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="426.499" x="25" y="396.7383">first deliverable (e.g. token 0: CP0&#8594;CP1 and token 1: CP1&#8594;CP0)</text><g class="message" data-participant-1="CP0" data-participant-2="A_1_0"><polygon fill="#181818" points="819.7974,417.791,829.7974,421.791,819.7974,425.791,823.7974,421.791" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="36.1387" x2="825.7974" y1="421.791" y2="421.791"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="43.1387" y="417.0488">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.5093" x="78.2104" y="417.0488">inceptTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.0171" x="176.7197" y="417.0488">(H(F),E(F))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.3433" x="246.6455" y="417.0488">(request token 1 from CP1: Keys=__,E(F))</text></g><g class="message" data-participant-1="CP1" data-participant-2="MPDvP"><polygon fill="#181818" points="561.7686,447.1016,571.7686,451.1016,561.7686,455.1016,565.7686,451.1016" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="78.416" x2="567.7686" y1="451.1016" y2="451.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="85.416" y="446.3594">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.5093" x="120.4878" y="446.3594">inceptTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.5415" x="218.9971" y="446.3594">(E(S),E(F))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.8457" x="288.9229" y="446.3594">(request token 0 from CP0: Keys=E(S),E(F))</text></g><g class="message" data-participant-1="CP1" data-participant-2="A_1_0"><polygon fill="#181818" points="814.7974,476.4121,824.7974,480.4121,814.7974,484.4121,818.7974,480.4121" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="78.416" x2="820.7974" y1="480.4121" y2="480.4121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="85.416" y="475.6699">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.2178" x="120.4878" y="475.6699">confirmTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.0806" x="229.7056" y="475.6699">(H(S),E(S))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235.8281" x="299.6313" y="475.6699">(lock token 1 of CP1:     Keys=E(S),__)</text></g><g class="message" data-participant-1="A_1_0" data-participant-2="A_1_0"><line style="stroke:#181818;stroke-width:1;" x1="836.7974" x2="878.7974" y1="509.7227" y2="509.7227"/><line style="stroke:#181818;stroke-width:1;" x1="878.7974" x2="878.7974" y1="509.7227" y2="522.7227"/><line style="stroke:#181818;stroke-width:1;" x1="837.7974" x2="878.7974" y1="522.7227" y2="522.7227"/><polygon fill="#181818" points="847.7974,518.7227,837.7974,522.7227,847.7974,526.7227,843.7974,522.7227" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="843.7974" y="504.9805">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.5952" x="878.8691" y="504.9805">lock token 1 of CP1</text></g><g class="message" data-participant-1="CP0" data-participant-2="MPDvP"><polygon fill="#181818" points="561.7686,548.0332,571.7686,552.0332,561.7686,556.0332,565.7686,552.0332" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="36.1387" x2="567.7686" y1="552.0332" y2="552.0332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="43.1387" y="547.291">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.2178" x="78.2104" y="547.291">confirmTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.5415" x="187.4282" y="547.291">(E(S),E(F))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.189" x="257.354" y="547.291">(replaces transferAndDecrypt)</text></g><path d="M10,574.0332 L468.4038,574.0332 L468.4038,581.3438 L458.4038,591.3438 L10,591.3438 L10,574.0332" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="176.8633" style="stroke:#000000;stroke-width:1.5;" width="1207.1313" x="10" y="574.0332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="413.4038" x="25" y="587.6016">second deliverable (e.g. token 2 CP0&#8594;CP2, token 0 CP2&#8594;CP0)</text><g class="message" data-participant-1="CP2" data-participant-2="A_0_2"><polygon fill="#181818" points="1012.4644,608.6543,1022.4644,612.6543,1012.4644,616.6543,1016.4644,612.6543" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="120.6934" x2="1018.4644" y1="612.6543" y2="612.6543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="127.6934" y="607.9121">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.5093" x="162.7651" y="607.9121">inceptTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.0171" x="261.2744" y="607.9121">(H(F),E(F))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.3433" x="331.2002" y="607.9121">(request token 2 from CP0: Keys=__,E(F))</text></g><g class="message" data-participant-1="CP0" data-participant-2="MPDvP"><polygon fill="#181818" points="561.7686,637.9648,571.7686,641.9648,561.7686,645.9648,565.7686,641.9648" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="36.1387" x2="567.7686" y1="641.9648" y2="641.9648"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="43.1387" y="637.2227">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.5093" x="78.2104" y="637.2227">inceptTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.5415" x="176.7197" y="637.2227">(E(S),E(F))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.8457" x="246.6455" y="637.2227">(request token 0 from CP2: Keys=E(S),E(F))</text></g><g class="message" data-participant-1="CP0" data-participant-2="A_0_2"><polygon fill="#181818" points="1007.4644,667.2754,1017.4644,671.2754,1007.4644,675.2754,1011.4644,671.2754" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="36.1387" x2="1013.4644" y1="671.2754" y2="671.2754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="43.1387" y="666.5332">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.2178" x="78.2104" y="666.5332">confirmTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.0806" x="187.4282" y="666.5332">(H(S),E(S))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245.2988" x="257.354" y="666.5332">(lock token 2 of CP0:     Keys=E(S),E(F))</text></g><g class="message" data-participant-1="A_0_2" data-participant-2="A_0_2"><line style="stroke:#181818;stroke-width:1;" x1="1029.4644" x2="1071.4644" y1="700.5859" y2="700.5859"/><line style="stroke:#181818;stroke-width:1;" x1="1071.4644" x2="1071.4644" y1="700.5859" y2="713.5859"/><line style="stroke:#181818;stroke-width:1;" x1="1030.4644" x2="1071.4644" y1="713.5859" y2="713.5859"/><polygon fill="#181818" points="1040.4644,709.5859,1030.4644,713.5859,1040.4644,717.5859,1036.4644,713.5859" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1036.4644" y="695.8438">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.5952" x="1071.5361" y="695.8438">lock token 2 of CP0</text></g><g class="message" data-participant-1="CP2" data-participant-2="MPDvP"><polygon fill="#181818" points="561.7686,738.8965,571.7686,742.8965,561.7686,746.8965,565.7686,742.8965" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="120.6934" x2="567.7686" y1="742.8965" y2="742.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="127.6934" y="738.1543">[14]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.2178" x="162.7651" y="738.1543">confirmTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.5415" x="271.9829" y="738.1543">(E(S),E(F))</text></g><path d="M1202,762.8965 L1202,828.8965 L1231,828.8965 L1231,772.8965 L1221,762.8965 L1202,762.8965" fill="#FFFFFF"/><path d="M1221,762.8965 L1221,772.8965 L1231,772.8965 L1221,762.8965" fill="#FFFFFF"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="8.9688" x="1208" y="783.3652">&#8226;</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="8.9688" x="1208" y="802.209">&#8226;</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="8.9688" x="1208" y="821.0527">&#8226;</text><path d="M10,841.4277 L451.5952,841.4277 L451.5952,848.7383 L441.5952,858.7383 L10,858.7383 L10,841.4277" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="176.8633" style="stroke:#000000;stroke-width:1.5;" width="1535.9058" x="10" y="841.4277"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="396.5952" x="25" y="854.9961">n-th deliverable (e.g. token n CP0&#8594;CPn, token 0 CPn&#8594;CP0)</text><g class="message" data-participant-1="CPn" data-participant-2="A_0_n"><polygon fill="#181818" points="1341.3911,876.0488,1351.3911,880.0488,1341.3911,884.0488,1345.3911,880.0488" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="217.1582" x2="1347.3911" y1="880.0488" y2="880.0488"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="224.1582" y="875.3066">[15]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.5093" x="259.23" y="875.3066">inceptTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.0171" x="357.7393" y="875.3066">(H(F),E(F))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.1909" x="427.665" y="875.3066">(request token n from CP0: Keys=__,E(F))</text></g><g class="message" data-participant-1="CP0" data-participant-2="MPDvP"><polygon fill="#181818" points="561.7686,905.3594,571.7686,909.3594,561.7686,913.3594,565.7686,909.3594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="36.1387" x2="567.7686" y1="909.3594" y2="909.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="43.1387" y="904.6172">[16]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.5093" x="78.2104" y="904.6172">inceptTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.5415" x="176.7197" y="904.6172">(E(S),E(F))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.6934" x="246.6455" y="904.6172">(request token 0 from CPn: Keys=E(S),E(F))</text></g><g class="message" data-participant-1="CP0" data-participant-2="A_0_n"><polygon fill="#181818" points="1336.3911,934.6699,1346.3911,938.6699,1336.3911,942.6699,1340.3911,938.6699" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="36.1387" x2="1342.3911" y1="938.6699" y2="938.6699"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="43.1387" y="933.9277">[17]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.2178" x="78.2104" y="933.9277">confirmTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.0806" x="187.4282" y="933.9277">(H(S),E(S))</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.4492" x="257.354" y="933.9277">(lock token n of CP0:   Keys=E(S),__)</text></g><g class="message" data-participant-1="A_0_n" data-participant-2="A_0_n"><line style="stroke:#181818;stroke-width:1;" x1="1358.3911" x2="1400.3911" y1="967.9805" y2="967.9805"/><line style="stroke:#181818;stroke-width:1;" x1="1400.3911" x2="1400.3911" y1="967.9805" y2="980.9805"/><line style="stroke:#181818;stroke-width:1;" x1="1359.3911" x2="1400.3911" y1="980.9805" y2="980.9805"/><polygon fill="#181818" points="1369.3911,976.9805,1359.3911,980.9805,1369.3911,984.9805,1365.3911,980.9805" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="1365.3911" y="963.2383">[18]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.4429" x="1400.4629" y="963.2383">lock token n of CP0</text></g><g class="message" data-participant-1="CPn" data-participant-2="MPDvP"><polygon fill="#181818" points="561.7686,1006.291,571.7686,1010.291,561.7686,1014.291,565.7686,1010.291" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="217.1582" x2="567.7686" y1="1010.291" y2="1010.291"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="224.1582" y="1005.5488">[19]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.2178" x="259.23" y="1005.5488">confirmTransfer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.5415" x="368.4478" y="1005.5488">(E(S),E(F))</text></g><path d="M578,1030.291 L578,1058.291 L1377,1058.291 L1377,1040.291 L1367,1030.291 L578,1030.291" fill="#FFFFFF"/><path d="M1367,1030.291 L1367,1040.291 L1377,1040.291 L1367,1030.291" fill="#FFFFFF"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="148.6797" x="584" y="1050.7598">cancelAndDecrypt</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="624.6172" x="737.7422" y="1050.7598">is possible on MPDvP at any time, releasing failure key for all ILocking contracts.</text><path d="M578,1069.1348 L578,1097.1348 L1222,1097.1348 L1222,1079.1348 L1212,1069.1348 L578,1069.1348" fill="#FFFFFF"/><path d="M1212,1069.1348 L1212,1079.1348 L1222,1079.1348 L1212,1069.1348" fill="#FFFFFF"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="163.1563" x="584" y="1089.6035">transferAndDecrypt</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="455.4922" x="752.2188" y="1089.6035">needs to perform an on-chain locking to ensure atomicity.</text><g class="message" data-participant-1="CP0" data-participant-2="MPDvP"><polygon fill="#181818" points="556.7686,1120.2891,566.7686,1124.2891,556.7686,1128.2891,560.7686,1124.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="36.1387" x2="562.7686" y1="1124.2891" y2="1124.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="43.1387" y="1119.5469">[20]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132.5645" x="78.2104" y="1119.5469">transferAndDecrypt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.9478" x="214.8882" y="1119.5469">- finalize multi-party DvP</text></g><path d="M10,1139.2891 L72.1387,1139.2891 L72.1387,1146.5996 L62.1387,1156.5996 L10,1156.5996 L10,1139.2891" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="929.3418" style="stroke:#000000;stroke-width:1.5;" width="1624.5498" x="10" y="1139.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="25" y="1152.8574">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="86.0503" x="87.1387" y="1151.9238">[Transfer cash]</text><g class="message" data-participant-1="CP0" data-participant-2="A_0_n"><polygon fill="#F8F8F8" points="1341.3911,1158.5996,1351.3911,1162.5996,1341.3911,1166.5996,1345.3911,1162.5996" style="stroke:#F8F8F8;stroke-width:1;"/><line style="stroke:#F8F8F8;stroke-width:1;stroke-dasharray:2,2;" x1="36.1387" x2="1347.3911" y1="1162.5996" y2="1162.5996"/></g><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1191.9102" y2="1191.9102"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1191.9102" y2="1204.9102"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1204.9102" y2="1204.9102"/><polygon fill="#181818" points="589.7686,1200.9102,579.7686,1204.9102,589.7686,1208.9102,585.7686,1204.9102" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1187.168">[21]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.2422" x="620.8403" y="1187.168">lock net cash liability of CP0</text></g><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1234.2207" y2="1234.2207"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1234.2207" y2="1247.2207"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1247.2207" y2="1247.2207"/><polygon fill="#181818" points="589.7686,1243.2207,579.7686,1247.2207,589.7686,1251.2207,585.7686,1247.2207" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1229.4785">[22]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.2422" x="620.8403" y="1229.4785">lock net cash liability of CP1</text></g><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1276.5313" y2="1276.5313"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1276.5313" y2="1289.5313"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1289.5313" y2="1289.5313"/><polygon fill="#181818" points="589.7686,1285.5313,579.7686,1289.5313,589.7686,1293.5313,585.7686,1289.5313" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1271.7891">[23]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.2422" x="620.8403" y="1271.7891">lock net cash liability of CP2</text></g><path d="M583,1302.5313 L583,1330.5313 L610,1330.5313 L610,1312.5313 L600,1302.5313 L583,1302.5313" fill="#FFFFFF"/><path d="M600,1302.5313 L600,1312.5313 L610,1312.5313 L600,1302.5313" fill="#FFFFFF"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="6.5703" x="589" y="1323">&#8942;</text><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1357.6855" y2="1357.6855"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1357.6855" y2="1370.6855"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1370.6855" y2="1370.6855"/><polygon fill="#181818" points="589.7686,1366.6855,579.7686,1370.6855,589.7686,1374.6855,585.7686,1370.6855" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1352.9434">[24]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.0898" x="620.8403" y="1352.9434">lock net cash liability of CPn</text></g><g class="message" data-participant-1="CP0" data-participant-2="A_0_n"><polygon fill="#FFF8F8" points="1341.3911,1380.6855,1351.3911,1384.6855,1341.3911,1388.6855,1345.3911,1384.6855" style="stroke:#FFF8F8;stroke-width:1;"/><line style="stroke:#FFF8F8;stroke-width:1;stroke-dasharray:2,2;" x1="36.1387" x2="1347.3911" y1="1384.6855" y2="1384.6855"/></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="1634.5498" y1="1393.6855" y2="1393.6855"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4.0767" x="15" y="1404.3203">[</text><text fill="#008000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="44.0376" x="19.0767" y="1404.3203">success</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4.0767" x="63.1143" y="1404.3203">]</text><g class="message" data-participant-1="CP0" data-participant-2="A_0_n"><polygon fill="#FFF8F8" points="1341.3911,1409.6406,1351.3911,1413.6406,1341.3911,1417.6406,1345.3911,1413.6406" style="stroke:#FFF8F8;stroke-width:1;"/><line style="stroke:#FFF8F8;stroke-width:1;stroke-dasharray:2,2;" x1="36.1387" x2="1347.3911" y1="1413.6406" y2="1413.6406"/></g><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1442.9512" y2="1442.9512"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1442.9512" y2="1455.9512"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1455.9512" y2="1455.9512"/><polygon fill="#181818" points="589.7686,1451.9512,579.7686,1455.9512,589.7686,1459.9512,585.7686,1455.9512" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1438.209">[25]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.6216" x="620.8403" y="1438.209">release net cash claim to CP0</text></g><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1485.2617" y2="1485.2617"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1485.2617" y2="1498.2617"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1498.2617" y2="1498.2617"/><polygon fill="#181818" points="589.7686,1494.2617,579.7686,1498.2617,589.7686,1502.2617,585.7686,1498.2617" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1480.5195">[26]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.6216" x="620.8403" y="1480.5195">release net cash claim to CP1</text></g><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1527.5723" y2="1527.5723"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1527.5723" y2="1540.5723"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1540.5723" y2="1540.5723"/><polygon fill="#181818" points="589.7686,1536.5723,579.7686,1540.5723,589.7686,1544.5723,585.7686,1540.5723" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1522.8301">[27]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.6216" x="620.8403" y="1522.8301">release net cash claim to CP2</text></g><path d="M583,1553.5723 L583,1581.5723 L610,1581.5723 L610,1563.5723 L600,1553.5723 L583,1553.5723" fill="#FFFFFF"/><path d="M600,1553.5723 L600,1563.5723 L610,1563.5723 L600,1553.5723" fill="#FFFFFF"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="6.5703" x="589" y="1574.041">&#8942;</text><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1608.7266" y2="1608.7266"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1608.7266" y2="1621.7266"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1621.7266" y2="1621.7266"/><polygon fill="#181818" points="589.7686,1617.7266,579.7686,1621.7266,589.7686,1625.7266,585.7686,1621.7266" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1603.9844">[28]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.4692" x="620.8403" y="1603.9844">release net cash claim to CPn</text></g><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1651.0371" y2="1651.0371"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1651.0371" y2="1664.0371"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1664.0371" y2="1664.0371"/><polygon fill="#181818" points="589.7686,1660.0371,579.7686,1664.0371,589.7686,1668.0371,585.7686,1664.0371" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1646.2949">[29]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.9937" x="620.8403" y="1646.2949">Release success key.</text></g><g class="message" data-participant-1="MPDvP" data-participant-2="DecryptionOracle"><polygon fill="#181818" points="1528.9058,1689.3477,1538.9058,1693.3477,1528.9058,1697.3477,1532.9058,1693.3477" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="573.7686" x2="1534.9058" y1="1693.3477" y2="1693.3477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="580.7686" y="1688.6055">[30]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="103.1304" x="615.8403" y="1688.6055">requestDecrypt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30.9575" x="718.9707" y="1688.6055">(E(S))</text></g><g class="message" data-participant-1="DecryptionOracle" data-participant-2="MPDvP"><polygon fill="#181818" points="584.7686,1718.6582,574.7686,1722.6582,584.7686,1726.6582,580.7686,1722.6582" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="1544.9058" y1="1722.6582" y2="1722.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="590.7686" y="1717.916">[31]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93.4819" x="625.8403" y="1717.916">onKeyDecrypt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4565" x="719.3223" y="1717.916">(S)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="1634.5498" y1="1731.6582" y2="1731.6582"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4.0767" x="15" y="1742.293">[</text><text fill="#FF0000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="18.1812" x="19.0767" y="1742.293">fail</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4.0767" x="37.2578" y="1742.293">]</text><g class="message" data-participant-1="CP0" data-participant-2="A_0_n"><polygon fill="#FFF8F8" points="1341.3911,1747.6133,1351.3911,1751.6133,1341.3911,1755.6133,1345.3911,1751.6133" style="stroke:#FFF8F8;stroke-width:1;"/><line style="stroke:#FFF8F8;stroke-width:1;stroke-dasharray:2,2;" x1="36.1387" x2="1347.3911" y1="1751.6133" y2="1751.6133"/></g><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1780.9238" y2="1780.9238"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1780.9238" y2="1793.9238"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1793.9238" y2="1793.9238"/><polygon fill="#181818" points="589.7686,1789.9238,579.7686,1793.9238,589.7686,1797.9238,585.7686,1793.9238" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1776.1816">[32]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.957" x="620.8403" y="1776.1816">revert net cash liability of CP0</text></g><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1823.2344" y2="1823.2344"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1823.2344" y2="1836.2344"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1836.2344" y2="1836.2344"/><polygon fill="#181818" points="589.7686,1832.2344,579.7686,1836.2344,589.7686,1840.2344,585.7686,1836.2344" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1818.4922">[33]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.957" x="620.8403" y="1818.4922">revert net cash liability of CP1</text></g><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1865.5449" y2="1865.5449"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1865.5449" y2="1878.5449"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1878.5449" y2="1878.5449"/><polygon fill="#181818" points="589.7686,1874.5449,579.7686,1878.5449,589.7686,1882.5449,585.7686,1878.5449" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1860.8027">[34]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.957" x="620.8403" y="1860.8027">revert net cash liability of CP2</text></g><path d="M583,1891.5449 L583,1919.5449 L610,1919.5449 L610,1901.5449 L600,1891.5449 L583,1891.5449" fill="#FFFFFF"/><path d="M600,1891.5449 L600,1901.5449 L610,1901.5449 L600,1891.5449" fill="#FFFFFF"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="6.5703" x="589" y="1912.0137">&#8942;</text><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1946.6992" y2="1946.6992"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1946.6992" y2="1959.6992"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="1959.6992" y2="1959.6992"/><polygon fill="#181818" points="589.7686,1955.6992,579.7686,1959.6992,589.7686,1963.6992,585.7686,1959.6992" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1941.957">[35]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.8047" x="620.8403" y="1941.957">revert net cash liability of CPn</text></g><g class="message" data-participant-1="MPDvP" data-participant-2="MPDvP"><line style="stroke:#181818;stroke-width:1;" x1="578.7686" x2="620.7686" y1="1989.0098" y2="1989.0098"/><line style="stroke:#181818;stroke-width:1;" x1="620.7686" x2="620.7686" y1="1989.0098" y2="2002.0098"/><line style="stroke:#181818;stroke-width:1;" x1="579.7686" x2="620.7686" y1="2002.0098" y2="2002.0098"/><polygon fill="#181818" points="589.7686,1998.0098,579.7686,2002.0098,589.7686,2006.0098,585.7686,2002.0098" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="585.7686" y="1984.2676">[36]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.5894" x="620.8403" y="1984.2676">Release failure key.</text></g><g class="message" data-participant-1="MPDvP" data-participant-2="DecryptionOracle"><polygon fill="#181818" points="1528.9058,2027.3203,1538.9058,2031.3203,1528.9058,2035.3203,1532.9058,2031.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="573.7686" x2="1534.9058" y1="2031.3203" y2="2031.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="580.7686" y="2026.5781">[37]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="103.1304" x="615.8403" y="2026.5781">requestDecrypt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30.9258" x="718.9707" y="2026.5781">(E(F))</text></g><g class="message" data-participant-1="DecryptionOracle" data-participant-2="MPDvP"><polygon fill="#181818" points="589.7686,2056.6309,579.7686,2060.6309,589.7686,2064.6309,585.7686,2060.6309" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="583.7686" x2="1544.9058" y1="2060.6309" y2="2060.6309"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.7871" x="595.7686" y="2055.8887">[38]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93.4819" x="630.8403" y="2055.8887">onKeyDecrypt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4248" x="724.3223" y="2055.8887">(F)</text></g><path d="M578,2080.6309 L578,2127.6309 L1533,2127.6309 L1533,2090.6309 L1523,2080.6309 L578,2080.6309" fill="#FFFFFF"/><path d="M1523,2080.6309 L1523,2090.6309 L1533,2090.6309 L1523,2080.6309" fill="#FFFFFF"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="934.5703" x="584" y="2101.0996">The descrption oracle receives the decryption request of the encrypted key associated with the outcome and decrypts it.</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="414.4141" x="584" y="2119.9434">The decrypted key is passed back via onKeyReleased.</text><path d="M41,2138.3184 L41,2185.3184 L1346,2185.3184 L1346,2148.3184 L1336,2138.3184 L41,2138.3184" fill="#FFFFFF"/><path d="M1336,2138.3184 L1336,2148.3184 L1346,2148.3184 L1336,2138.3184" fill="#FFFFFF"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="148.5547" x="47" y="2158.7871">All participants call</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="132.7188" x="200.6172" y="2158.7871">transferWithKey</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="993.2578" x="338.3984" y="2158.7871">on all locking contracts to unlock the asset, either releasing (success key S) or reverting (failure key F) the corresponding token.</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="1043.9766" x="47" y="2177.6309">The locking contract validates the given key K ( &#8712; {S,F} ) against the hashed values H(S), H(F) to validate the release or revert operation.</text><!--SRC=[pLbBRnit4BxlhnZ41rkkP3rQ58RW272Tg0cIj4Pje8SqCAXTIYAyIwfBoguQ1F2f2D1Rp-sbXnxxe_nBEaDo7zgLPDbfqcuIPvVaF3ZpSMOutfqQCzFzTdiMCsdcINmGggIj-OzpBaFUYWIRf2m90YDCpE7LF3QYTSfIi_3lnrfpuzzFfan8U79r6WJwKiWPGqhuYeMNarJDPNIYOfN2zLGO7WIxy8fTSf3AS0qnIoSSc8o0nOdI1aOgZNWQSwrBdBx1jQkvLTPOulNpPrCMgMiX9p1ciQxEdh8eehdU5vM9ePBcJFpCeVibgNzc5cWG9UC5c2c7H4GHVj_U_CxZMCmqlxtv0v3OY53CqBB1aIQ2GG2G6VU9iosynJ600prZ8K_z5rYxVLtTAVXd5yOYZa6DhUmfPr5xf7xob2-5v2jeCafdM_WCOZ7cCQw5no3abT1YP3VagKOJpoupoESTg3-xaA0RjLK3DG1aCsSnsWGDCMR6y1Jju1aL1Zoq8-y2-dVKzeO9M6XGvvFJ3Z1D_-K3NJVGpGTwRg0Nb0mCpduTE3foRuC1lBPo7k5ZNsvl_dH_Y-4tEK_fUCeWc8g8WqRLkJAB6MArBENLAUBRCzxVFrUNN49dVn_wTgI5ZsV-_0aFqyNC22LFSECfol5gBCrzYnCnFq6RZT3XLgEokEEBxaMd8gwxKjnB5I9S9oLPDLQTYrw5LMzBLYLxrKtUlQ_9wonwoonMgIuhgiiFKxtgWPnxCG5kvWxdkaNEt06R6oNdoGZFrwEZqU1rf_C6ZjgZmIEA64WENtF9KsQvu-75A41SUDIUCZtb4LpoXQPr0SMu6UmC3-dFDbIe69sSrg2-ipwa576qUPeHFhDqB_XYB_I6QeA86iW3NyKLm-DVux9ps3di38UufZRLGgaal0zFzyuQJNY6Ft5TnDTo2_ulwWwjkiExrEKo2WBALP2AoTIG5uZ3Zail19ldoKob1f7LHxmSOsosOECsa3LlR_vgKeG96Jfmf7bwnJ5YCkFyxOn6ki0r1XsOE6-ZOqSkjvXqhkbpJybMI3csWShcA5LkLvbf3b2TywdG21CzJsreHa5IMOKMS2dLjGR91J9EBVUKnvnfJhh0dfw78MPT-cZ2MGFfiaLNF3LkpPY963cxDSF60Ld79l8xJ4H9bAnpZln237XW58wYJK8U7yl86nqNeF8pfVDyv48kRe99j8T8UDFhx59uhWoCKLdYcqM1t2Qwh6FvQ0qnZwPORqIO2763Z2JkyOF90Ufc8tkVDd7xosys2I4BDzobuQuTxZI2m2FPnke-RadWZcRcF6LIZtcwlxz726kIWnlmWu4zZ- -C6OnJbH33FY36zUEB2xSs8A78r-v_9L-Bd7LyEndVZkTRhCuuvngZeT0GoPBATl6PPnsZHNDzhMjHMteApXSNZI0_GIvlxGo7T0m3zrK8NC4jjsA-sxfEjUrYpHeImlsI0aIDe7IQbtMnIB0Og491SnGPhSL2BuT2hvcR63zo6Eo2mpBM3bISPH2cdVNSvZ41tnyVlQeVI_Ze_1luwAt2HsT9u_lWe-UFVXKVZdF9ArIE50YXhqBa2dwv7RT2o380aEUIussSKkXbufrLCNceSkLAyNDTx90jCrqB5vd3HPRX8ajHGsORblT7XVpOg91rL9HX8UyB2rc2nNBGMCQ4NC94sKGhcELMV10cv18cAidBPPrI-lhaYUeEVUfH3pMId4UQ4kkCfoWb0QeuVDLW3KZISDeL1wYhIh0YDekotDqgWbPAShuDiJGZxKffS3DP2pEkP35T0nFRD71b2JKDSj_uhLBzHW6RmWYBJLuDPxwrmeFi9beglRLHiw2ueKxnOeLoYpikxZ-NHPTWe5jmJe3RQBtsijwq1WvygyHWSJLFU91FERKB2rW3IMwSaMB1HY96KsVGVH1Pzs5alKBBZQZAdjjV_yw_2c0yIBGCFfgBXgjTL3hbLa4xmMCiSSchI0H78RL7-fEKSpdm9UzHsmuEjXIo1gmFW4bMV-S636Cc4hB09fHieke-YEhZOcIJPBcUx3jFLhgN7AnONRsmKVZnUIqFFJOHD3QZPCcp6-wKxgdVB4lHJqdCSeNmivMIQnVDtJlmjRiDo2raCv2dF1fGxgdX-nETnlf9sF88rH5ahw3t3wXt47OVIlYn3yn6uLkScLB5yG5dPlZVdPdXTcTc2pnH_sRj9eAjF4XTYuZhC5tgkgGyv5Z-kmPugIcJ5TM-Gv-tx6pvnxHMeR0Tdck1LmXQeUOcL8dx9OZdeq7ORauXlSo4QazaH5qYEgvNWe4rd_T-T13KSRQXFKDFthPoFLBjkZH58VSzAeiIi8h37T9KN2rVALBCfIlKKMFIppJ1DvkAMhZSPg8kaqeztErakL8UDYoZKAKOF6PuFNVrAzu1ofQfwW5NM656p7Y_JD13qh9x0Njm-_uzl3rh3jz10zW4wsAw-z1lKLmp5KdHSxQ7wLg3jAUCtrB3BDSQrCotPoj6_mS0]--></g></svg>